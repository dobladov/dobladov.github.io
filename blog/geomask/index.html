<!DOCTYPE html><html lang="en" data-astro-cid-colb5upu> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/png" href="/orb512.png"><meta name="generator" content="Astro v5.16.5"><link rel="manifest" href="/manifest.webmanifest"><meta http-equiv="content-language" content="en"><link rel="alternate" type="application/rss+xml" title="RSS feed" href="/rss.xml"><link rel="alternate" type="application/feed+json" title="JSON feed" href="/feed.json"><!-- Canonical URL --><link rel="canonical" href="https://dobla.do/blog/geomask/"><link rel="sitemap" href="/sitemap-index.xml"><!-- Primary Meta Tags --><title>GeoMask: geolocation spoofing extension - Daniel Doblado</title><meta name="title" content="GeoMask: geolocation spoofing extension"><meta name="description" content="A way to easily spoof your geolocation in Firefox and Chrome for development and privacy purposes."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://dobla.do/blog/geomask/"><meta property="og:title" content="GeoMask: geolocation spoofing extension"><meta property="og:description" content="A way to easily spoof your geolocation in Firefox and Chrome for development and privacy purposes."><meta property="og:image" content="https://dobla.do/orb512.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://dobla.do/blog/geomask/"><meta property="twitter:title" content="GeoMask: geolocation spoofing extension"><meta property="twitter:description" content="A way to easily spoof your geolocation in Firefox and Chrome for development and privacy purposes."><meta property="twitter:image" content="https://dobla.do/orb512.png"><!-- Mastodon --><meta name="fediverse:creator" content="@danieldobla@mastodon.social"><script type="module">document.body.removeAttribute("data-js");</script><style>article{margin:0 auto;max-width:46rem}article p{margin-bottom:2em}@media screen and (min-width:468px){article{margin-top:2rem}}.toArticle{position:fixed;top:-100%;left:50%;transform:translate(-50%);transition:top .3s ease-in-out;padding:0 1rem}.toArticle:focus{top:1%}#title{text-align:left}.date{text-align:right;font-style:italic}.description{font-size:2rem;line-height:110%;text-align:center}@keyframes adjust-progressbar{0%{height:0}to{height:100%}}aside:before,aside:after{content:"";position:absolute;top:0;left:0;width:.25rem;height:100%;background:var(--text);border-radius:.25rem}@supports (animation-timeline: scroll(block root)){aside:after{background:var(--accent);animation:adjust-progressbar;animation-timeline:scroll(block root);animation-duration:auto}}aside{display:none;position:fixed;left:1rem;top:50%;max-width:15rem;transform:translateY(-50%);max-height:50vh;padding-left:1rem;padding-right:1rem}aside ul{list-style:none;margin:0;padding:0}aside a{text-overflow:ellipsis;display:inline-block;text-decoration:none;transition:transform .2s ease-out;transform-origin:left;line-height:1;padding-bottom:.5rem;color:var(--text)}aside a.active{color:var(--accent)}aside a:hover{transform:scale(1.1);color:var(--accent)}pre{margin-bottom:2rem}@media screen and (min-width:992px){img,pre{--space: 8rem;width:calc(100% + var(--space));position:relative;left:calc(var(--space) / -2);max-width:calc(100% + var(--space))!important}#title{--space: 5rem;width:calc(100% + var(--space));position:relative;left:calc(var(--space) / -2);font-size:4rem}}@media screen and (min-width:1300px){aside{display:block}}summary{cursor:pointer}.details{font-family:Courier New,monospace;padding-top:1rem}#metadata{display:flex;flex-direction:column;justify-content:space-between;font-size:.8rem}.tags{display:flex;flex-wrap:wrap;column-gap:.5rem;justify-content:flex-end}.metaSection{gap:1.5rem;display:flex;justify-content:space-between;border-top:1px solid var(--text);padding-top:.2rem;padding-bottom:.2rem}.centered{padding-top:1rem}.correctLink{margin-top:1.5rem}@media print{article{max-width:210mm;width:210mm}.toArticle,.date,.correctLink,details{display:none}}
</style>
<link rel="stylesheet" href="/_astro/_slug_.CTIEadp6.css">
<style>.separator[data-astro-cid-jchhmuzl]{color:var(--link)}
</style></head> <body data-js="false" data-astro-cid-colb5upu> <a class="toArticle" href="#article">To the article</a> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <h1 data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>Daniel Doblado</a> </h1> <div class="internalLinks" data-astro-cid-3ef6ksr2> <a href="/blog" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Blog </a>  <a href="/projects" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Projects </a>  <a href="/tags" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg> Tags </a>  <a href="/rss.xml" class="rss" title="RSS" data-astro-cid-3ef6ksr2="true" data-astro-cid-eimmu3lg>  <svg width="1.01em" height="1em" data-astro-cid-3ef6ksr2="true" data-icon="rss">   <symbol id="ai:local:rss" viewBox="0 0 82.459 82.347"><g fill="currentColor" transform="translate(-10.112 -9.668)"><circle cx="21.243" cy="80.884" r="11.131"/><path d="M18.229 40.126a7.626 7.626 0 1 0 0 15.253c15.917 0 28.865 12.95 28.865 28.865a7.626 7.626 0 0 0 7.628 7.627 7.627 7.627 0 0 0 7.627-7.627c0-24.326-19.793-44.118-44.12-44.118"/><path d="M17.997 9.668a7.628 7.628 0 0 0 0 15.254c32.708.001 59.32 26.613 59.32 59.322a7.627 7.627 0 1 0 15.254 0c0-41.118-33.453-74.573-74.574-74.576"/></g></symbol><use href="#ai:local:rss"></use>  </svg>  </a>  <!-- <ThemeToggle /> --> </div> </nav> <svg style="width: 0; height: 0" xmlns="http://www.w3.org/2000/svg" version="1.1" data-astro-cid-3ef6ksr2> <defs data-astro-cid-3ef6ksr2> <filter id="goovey" data-astro-cid-3ef6ksr2> <feTurbulence type="fractalNoise" baseFrequency="0.03" numOctaves="1" result="warpper" data-astro-cid-3ef6ksr2></feTurbulence> <feColorMatrix in="warpper" type="hueRotate" data-astro-cid-3ef6ksr2> <animate attributeType="XML" attributeName="values" values="0;110;150;210;360" dur="6s" repeatCount="indefinite" data-astro-cid-3ef6ksr2></animate> </feColorMatrix> <feDisplacementMap xChannelSelector="R" yChannelSelector="G" scale="20" in="SourceGraphic" data-astro-cid-3ef6ksr2></feDisplacementMap> </filter> </defs> </svg> <div class="pattern" data-astro-cid-pj7xj6mf></div> </header> <main data-astro-cid-colb5upu> <section data-astro-cid-colb5upu>   <article id="article"> <header> <h1 id="title">GeoMask: geolocation spoofing extension</h1> <div class="date"> 4 min read<span class="separator" data-astro-cid-jchhmuzl>&nbsp;·&nbsp;</span><time datetime="2025-12-15T00:00:00.000Z"> Dec 15, 2025 </time>  </div> </header> <aside> <ul> <li> <a title="Navigate to the start of the article" href="#title">Start</a> </li> <li> <a href="#introduction">Introduction</a> </li><li> <a href="#goals">Goals</a> </li><li> <a href="#development">Development</a> </li> <li> <a id="metadataLink" title="Navigate to the end of the article" href="#metadata">Metadata</a> </li> </ul> </aside> <p class="description"> A way to easily spoof your geolocation in Firefox and Chrome for development and privacy purposes. </p>  <h2 id="introduction">Introduction<a aria-hidden="true" tabindex="-1" href="#introduction"><span class="icon icon-link"></span></a></h2>
<p>Earlier this year I switched back to Firefox, I want to move away from Google services as much as possible, and one feature that I used sometimes was the ability to spoof my geolocation, not even for nefarious purposes or privacy, mostly for development.</p>
<p>This is something really easy to do on Chrome, without even having to resort to extensions, simply open the developer tools, go to the “Sensors” tab and change your location to whatever place you want, I wish Firefox had something similar built-in, but it doesn’t.</p>
<p>My first attempt was to use an existing extension, I couldn’t find any that worked well, most of them were either outdated, not working at all, or had the most unintuitive user interface imaginable.</p>
<p>When there are no good options, the best option is to make your own, so I created <a href="https://github.com/dobladov/geomask" rel="nofollow" target="_blank">GeoMask</a> following the development mindset that I’m going to call “Better Execution, Same Task” (BEST), the idea is to look at existing solutions, see what they do well and what they don’t, and then make something that does it slightly better in each aspect, nothing groundbreaking.</p>
<h2 id="goals">Goals<a aria-hidden="true" tabindex="-1" href="#goals"><span class="icon icon-link"></span></a></h2>
<p>Let’s start by understanding the main feature, <strong>changing the location directly in the extension popup</strong>, this might sound crazy but most of the extensions I tried, required an options page buried in settings or navigating to a hosted webpage where JS is injected to add UI where the location can be set, and most of those sites are offline and not maintained anymore.</p>
<p>I believe these extensions have weird designs because of how limited and hard to work with the WebExtension APIs are, even more after manifest v3 changes, most of the code has to run isolated from the extension UI, requiring to add weird communication between layers, inject scripts which are very limited, etc, I don’t want to rant much about it, but clearly Google does not like extensions and it’s forcing Mozilla to follow their enshittification practices.</p>
<p>My extension needs to do the minimum as Google’s devtool, a popup with two text fields for latitude and longitude, and a button to apply the changes, and what can be better than that?, if the popup also shows a map with a pin that can be dragged to change the location visually, and search box to find places quickly.</p>
<h2 id="development">Development<a aria-hidden="true" tabindex="-1" href="#development"><span class="icon icon-link"></span></a></h2>
<p>With that in mind, I created a simple map with <a href="https://leafletjs.com/" rel="nofollow" target="_blank">Leaflet</a>, my initial thought was to use <a href="https://d3js.org/d3-geo" rel="nofollow" target="_blank">d3-geo</a> with a self contained geojson map of the world, but leaflet gives a lot of features out of the box, zoom, panning, and more rich map information, in my opinion is a worthy dependency.</p>
<p>Now that I have a map, I can set coordinates, change the position easily, I need to do the most annoying part of this project, overriding the browsers’s <a href="https://developer.mozilla.org/en-US/docs/Web/API/Navigator/geolocation" rel="nofollow" target="_blank">geolocation API</a>, with the selected coordinates.</p>
<p>For that the <a href="https://github.com/dobladov/geomask/blob/main/extension/popup/popup.mjs" rel="nofollow" target="_blank">popup</a> needs to be able to store the coordinates using <a href="https://developer.mozilla.org/en-US/docs/Web/API/Storage" rel="nofollow" target="_blank">browserAPI.storage.local.set</a>, then a <a href="https://github.com/dobladov/geomask/blob/main/extension/content.js" rel="nofollow" target="_blank">content</a> script listens to storage changes with <code>browserAPI.storage.onChanged.addListener</code> in order store the coordinates on the page context, but unfortunately a content script cannot override the geolocation API directly, so it needs to <a href="https://github.com/dobladov/geomask/blob/main/extension/inject.js" rel="nofollow" target="_blank">inject</a> a <code>web_accessible_resources</code> that overrides the <code>navigator.geolocation.getCurrentPosition</code> and <code>navigator.geolocation.watchPosition</code> methods to return the spoofed coordinates, where this data can be read from the <code>root.dataset</code>.</p>
<p>At this point I had a functional extension that could change the location, to polish it a bit more, I added a search box using <a href="https://nominatim.org/release-docs/develop/api/Search/" rel="nofollow" target="_blank">Nominatim</a> to find places quickly, a way to reset the location to the real one, dark and light mode, some error handling for invalid coordinates, and a randomize button with distance options.</p>
<p><img src="/_astro/geomask-screenshot.Dzi2DR_n_19n0F4.webp" alt="GeoMask Extension Popup" loading="lazy" decoding="async" fetchpriority="auto" width="840" height="1090"></p>
<p>For the extension itself I decided to use vanilla JS with <a href="https://jsdoc.app/" rel="nofollow" target="_blank">JSDOC</a> types validated by typescript to avoid any build step and no UI frameworks, given that there’s not much UI, keeping the extension lightweight and simple, <em>92.1 KB</em> for <a href="https://github.com/dobladov/geomask/releases/tag/1.0.0" rel="nofollow" target="_blank">1.0.0</a></p>
<p>The extensions should be available soon once approved.</p>  <!-- <Share title={title} description={description} url={href} /> --> <details class="details"> <summary>Metadata</summary> <div id="metadata"> <div class="metaSection"> <span class="title">Published</span> <time datetime="2025-12-15T00:00:00.000Z"> Dec 15, 2025 </time> </div>  <div class="metaSection"> <span class="title">Length</span> <span>4 min read (652 words)</span> </div> <div class="metaSection"> <span class="title">License</span> <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> </div> <div class="metaSection"> <span class="title">Tags</span> <div class="tags">  <a href="/tags/extension">#extension </a>  <a href="/tags/geolocation">#geolocation </a>  <a href="/tags/firefox">#firefox </a>  <a href="/tags/privacy">#privacy </a>  <a href="/tags/chrome">#chrome </a>  <a href="/tags/web-development">#web-development </a>  <a href="/tags/javascript">#javascript </a>  <a href="/tags/typescript">#typescript </a>  <a href="/tags/web-extensions">#web-extensions </a>  <a href="/tags/addons">#addons </a>  <a href="/tags/leaflet">#leaflet </a>  <a href="/tags/d3-geo">#d3-geo </a>  <a href="/tags/nominatim">#nominatim </a>  <a href="/tags/mapping">#mapping</a>  </div> </div> <div class="centered"> <a class="correctLink" target="_blank" href="https://github.com/dobladov/astro-blog/edit/main/src/content/blog/geomask/index.mdx">Did I make a mistake? Please consider sending a pull request</a> </div> <script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"GeoMask: geolocation spoofing extension","editor":"Daniel Doblado","genre":"extension geolocation firefox privacy chrome web-development javascript typescript web-extensions addons leaflet d3-geo nominatim mapping","keywords":"extension geolocation firefox privacy chrome web-development javascript typescript web-extensions addons leaflet d3-geo nominatim mapping","wordcount":652,"url":"https://dobla.do/blog/geomask/","datePublished":"2025-12-15T00:00:00.000Z","dateCreated":"2025-12-15T00:00:00.000Z","description":"A way to easily spoof your geolocation in Firefox and Chrome for development and privacy purposes.","author":{"url":"https://dobla.do","@type":"Person","name":"Daniel Doblado"}}</script> </div> </details> <div class="progress"></div> </article>  </section> </main> <footer data-astro-cid-sz7xmlte> <a target="_blank" href="https://codepen.io/dobladov" data-astro-cid-sz7xmlte>CodePen</a> <a target="_blank" href="mailto:danieldoblado@gmail.com" data-astro-cid-sz7xmlte>E-Mail</a> <a target="_blank" href="https://github.com/dobladov" data-astro-cid-sz7xmlte>GitHub</a> <a target="_blank" href="https://stackoverflow.com/users/2498992/daniel-doblado" data-astro-cid-sz7xmlte>StackOverflow</a> </footer>  <div class="pattern bottom" data-astro-cid-pj7xj6mf></div> </body></html> <script type="module">const r=document.querySelectorAll("#title, h2, #metadata"),n=new IntersectionObserver(e=>{const c=[...document.querySelectorAll("aside a")];e.forEach(t=>{const s=c.find(i=>i.href.endsWith(`#${t.target.id}`));t.isIntersecting?s?.classList.add("active"):s?.classList.remove("active")})},{threshold:.9});r.forEach(e=>{n.observe(e)});</script>