<!DOCTYPE html>
<html lang="en" class="astro-COLB5UPU">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <!-- Global Metadata --><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="icon" type="image/png" href="/orb512.png">
<meta name="generator" content="Astro v2.10.1">
<link rel="manifest" href="/manifest.webmanifest">

<!-- Canonical URL -->
<link rel="canonical" href="https://dobla.do/blog/writing-browser-extensions-without-compiling/">

<!-- Primary Meta Tags -->
<title>Writing browser extensions without compiling</title>
<meta name="title" content="Writing browser extensions without compiling">
<meta name="description" content="Positive changes for one of my extensions with the goal of making better extensions.">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://dobla.do/blog/writing-browser-extensions-without-compiling/">
<meta property="og:title" content="Writing browser extensions without compiling">
<meta property="og:description" content="Positive changes for one of my extensions with the goal of making better extensions.">
<!-- <meta property="og:image" content={new URL(image, Astro.url)} /> -->

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://dobla.do/blog/writing-browser-extensions-without-compiling/">
<meta property="twitter:title" content="Writing browser extensions without compiling">
<meta property="twitter:description" content="Positive changes for one of my extensions with the goal of making better extensions.">
<!-- <meta property="twitter:image" content={new URL(image, Astro.url)} /> -->
    <link rel="stylesheet" href="/_astro/_...slug_.95223ae8.css" />
<link rel="stylesheet" href="/_astro/_...slug_.23af7805.css" /><script type="module" src="/_astro/hoisted.335e4b07.js"></script></head>

    

    
    
    <body data-js="false" class="astro-COLB5UPU">
        <a class="toArticle" href="#article">To the article</a>
        

<header class="astro-3EF6KSR2">
	<nav class="astro-3EF6KSR2">
		<h1 class="astro-3EF6KSR2">
			<a href="/" class="astro-3EF6KSR2">Daniel Doblado</a>
		</h1>
		<div class="internalLinks astro-3EF6KSR2">
			<a href="/blog" class="astro-3EF6KSR2 astro-EIMMU3LG">
	Blog
</a>
			<a href="/projects" class="astro-3EF6KSR2 astro-EIMMU3LG">
	Projects
</a>
			<a href="/tags" class="astro-3EF6KSR2 astro-EIMMU3LG">
	Tags
</a>
			<a href="/rss.xml" class="astro-3EF6KSR2 astro-EIMMU3LG" title="RSS">
	
				<svg xml:space="preserve" viewBox="0 0 82.459 82.347" class="astro-3EF6KSR2" astro-icon="rss"><g transform="translate(-10.112 -9.668)"><circle cx="21.243" cy="80.884" r="11.131"/><path d="M18.229 40.126a7.626 7.626 0 1 0 0 15.253c15.917 0 28.865 12.95 28.865 28.865a7.626 7.626 0 0 0 7.628 7.627 7.627 7.627 0 0 0 7.627-7.627c0-24.326-19.793-44.118-44.12-44.118z"/><path d="M17.997 9.668a7.628 7.628 0 0 0 0 15.254c32.708.001 59.32 26.613 59.32 59.322a7.627 7.627 0 1 0 15.254 0c0-41.118-33.453-74.573-74.574-74.576z"/></g></svg>
			
</a>
			<!-- <ThemeToggle /> -->
		</div>
	</nav>	
</header>
        <main class="astro-COLB5UPU">
            <section class="astro-COLB5UPU">
                
    
    <article id="article">
        <header>
                <h1 id="title">Writing browser extensions without compiling</h1>
                <div class="date">
                    4 min read ‚Äî <time datetime="2021-06-24T00:00:00.000Z">
	Jun 24, 2021
</time>
                    
                </div>
            </header>
            
            <aside>
                    <ul>
                        <li>
                            <a title="Navigate to the start of the article" href="#title">Start</a>
                        </li>
                        <li>
                                <a href="#complexity-is-the-enemy">Complexity is the enemy</a>
                            </li>
                        <li>
                            <a id="metadataLink" title="Navigate to the end of the article" href="#metadata">Metadata</a>
                        </li>
                    </ul>
                </aside>

            <p class="description">
                Positive changes for one of my extensions with the goal of making better extensions.
            </p>
            
            
	<h2 id="complexity-is-the-enemy">Complexity is the enemy<a aria-hidden="true" tabindex="-1" href="#complexity-is-the-enemy"><span class="icon icon-link"></span></a></h2>
<p>Recently one of my most popular <a href="https://github.com/dobladov/youtube2Anki">extensions</a> received a full refactor, previously it was made with just pure JavaScript, this was fine since at the beginning it was a proof of concept, it means no complex bundles, frameworks, compilers, ‚Ä¶</p>
<p>But with complexity comes necessity, managing the state of the connection between the extension and Anki and editing the sentences got complicated using imperative logic; It‚Äôs amazing how used I became to declarative logic with <a href="https://reactjs.org/">React</a> and this is something that I was missing for this extension.</p>
<p>I could use React, the problem is that if the extension needs to be compiled, the review in the extensions stores will be more exhaustive, taking more time and making longer to fix simple stuff like bugs.</p>
<p>So in order to give trust and avoid wasting time in reviews, all the code needed to stay just as it was written.</p>
<p>Tools like <a href="https://www.snowpack.dev/">snowpack</a> made me realize that with the advance of JavaScript modules we might not need to compile what it‚Äôs an interpreted language, like seriously how did we reach this point.</p>
<h3 id="coming-with-simpler-solutions">Coming with simpler solutions<a aria-hidden="true" tabindex="-1" href="#coming-with-simpler-solutions"><span class="icon icon-link"></span></a></h3>
<p>Let‚Äôs look at the requirements, I wanted to use components, separate my logic from styles, use declarative logic, not set up any bundler (webpack, parcel, etc‚Ä¶) for this React would not make the cut since JSX needs some tooling and care.</p>
<p>So the decision went to <a href="https://skruv.io/">Skruv</a>, this framework is amazing, not only is tiny, modular and simple to learn, the docs are amazing well organized and clear, covering all functionality without extras.</p>
<p>You can tell how nice the framework is by looking at this framework‚Äôs goals:</p>
<ul>
<li>No build time or runtime dependencies, no parsers</li>
<li>Pretty small:
<ul>
<li>~350 LOC vDOM</li>
<li>~100 LOC State management</li>
<li>~300 LOC HTML/SVG helpers</li>
</ul>
</li>
<li>Useable without bundling/compilation/transpilation</li>
<li>Fast enough for most normal use cases: benchmark</li>
<li>Supports async components like import() and async generators</li>
<li>CSS scoping via shadow DOM</li>
<li>Hopefully grokable/understandable code</li>
</ul>
<p>The best part is that to use it I just have to import the files, that‚Äôs it.</p>
<pre is:raw="" class="astro-code github-dark" style="background-color: #24292e; overflow-x: auto;" tabindex="0"><code><span class="line"><span style="color: #F97583">import</span><span style="color: #E1E4E8"> { div } </span><span style="color: #F97583">from</span><span style="color: #E1E4E8">  </span><span style="color: #9ECBFF">'./skruv/html.js'</span></span>
<span class="line"><span style="color: #F97583">import</span><span style="color: #E1E4E8"> { renderNode } </span><span style="color: #F97583">from</span><span style="color: #E1E4E8">  </span><span style="color: #9ECBFF">'./skruv/vDOM.js'</span></span>
<span class="line"></span>
<span class="line"><span style="color: #F97583">let</span><span style="color: #E1E4E8"> root </span><span style="color: #F97583">=</span><span style="color: #E1E4E8"> document.</span><span style="color: #B392F0">querySelector</span><span style="color: #E1E4E8">(</span><span style="color: #9ECBFF">'#root'</span><span style="color: #E1E4E8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color: #E1E4E8">root </span><span style="color: #F97583">=</span><span style="color: #E1E4E8">  </span><span style="color: #B392F0">renderNode</span><span style="color: #E1E4E8">(</span></span>
<span class="line"><span style="color: #E1E4E8">	</span><span style="color: #B392F0">div</span><span style="color: #E1E4E8">({}, </span><span style="color: #9ECBFF">'Hello world!'</span><span style="color: #E1E4E8">),</span></span>
<span class="line"><span style="color: #E1E4E8">	root</span></span>
<span class="line"><span style="color: #E1E4E8">)</span></span></code></pre>
<p>On top of those advantages, I love the nested syntax, far shorter than JSX, now that I think about it feels weird that we moved to write HTML in JS.</p>
<p>You might be also wondering, ‚Äúwhat if I need typescript, do you have to transpile?‚Äù the answer is no, you can use <a href="https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html">JSDocs with Typescript</a> without having to create a single <code>ts</code> file.</p>
<h3 id="how-it-ended">How it ended<a aria-hidden="true" tabindex="-1" href="#how-it-ended"><span class="icon icon-link"></span></a></h3>
<p>I feel this change was a success, new code can be iterated easily without having to worry much about state or building, since the extension runs on modern browsers I don‚Äôt have to care about babel, etc</p>
<p>Right now the only concern I have about the extension is manifest v3 which is not supported in Firefox yet, but this is a story for another post.</p>
<p>I have to say that I‚Äôm glad about the feedback people gave, this refactor was motivated because changes on Youtube made it fail and people reported issues with a lot of support, not only that, but I‚Äôve seen articles written in Vietnamese, Japanese and German in how to use the extension and how they find it useful, it really makes want to keep contributing free, anti-traking open-source code.</p>


            <!-- <Share title={title} description={description} url={href} /> -->

            <details class="details">
                <summary>Metadata</summary>
                <div id="metadata">

                    <div class="metaSection">
                        <span class="title">Published</span>
                        <time datetime="2021-06-24T00:00:00.000Z">
	Jun 24, 2021
</time>
                    </div>
                    
                    
                    <div class="metaSection">
                        <span class="title">Length</span>
                        <span>4 min read (643 words)</span>
                    </div> 
                    
                   <div class="metaSection">
                       <span class="title">License</span>
                       <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>
                   </div>

                    <div class="metaSection">
                            <span class="title">Tags</span>
                            
                            <div class="tags">
                                <a href="/tags/javascript">#javascript</a><a href="/tags/extension">#extension</a><a href="/tags/tooling">#tooling</a><a href="/tags/framework">#framework</a>
                            </div>
                        </div>
    
                    <div class="centered">
                        <a class="correctLink" target="_blank" href="https://github.com/dobladov/astro-blog/edit/main/src/content/blog/writing-browser-extensions-without-compiling.md">Did I make a mistake? Please consider sending a pull request</a>
                    </div>

                    <script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Writing browser extensions without compiling","editor":"Daniel Doblado","genre":"javascript extension tooling framework","keywords":"javascript extension tooling framework","wordcount":643,"url":"https://dobla.do/blog/writing-browser-extensions-without-compiling/","datePublished":"2021-06-24T00:00:00.000Z","dateCreated":"2021-06-24T00:00:00.000Z","description":"Positive changes for one of my extensions with the goal of making better extensions.","author":{"@type":"Person","name":"Daniel Doblado"}}</script>
                </div>
            </details>
        <div class="progress"></div>
    </article>

            </section>
        </main>
        <footer class="astro-SZ7XMLTE">
	<a target="_blank" href="https://codepen.io/dobladov" class="astro-SZ7XMLTE">CodePen</a>
	<a target="_blank" href="mailto:danieldoblado@gmail.com" class="astro-SZ7XMLTE">E-Mail</a>
	<a target="_blank" href="https://github.com/dobladov" class="astro-SZ7XMLTE">GitHub</a>
	<a target="_blank" href="https://stackoverflow.com/users/2498992/daniel-doblado" class="astro-SZ7XMLTE">StackOverflow</a>
	<a target="_blank" href="https://mastodon.social/@danieldobla" class="astro-SZ7XMLTE">Mastodon</a>
	<a target="_blank" href="https://x.com/danieldobla" class="astro-SZ7XMLTE">ùïè</a>
</footer>
    </body></html>