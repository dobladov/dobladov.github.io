<!DOCTYPE html><html lang="en" data-astro-cid-colb5upu> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/png" href="/orb512.png"><meta name="generator" content="Astro v4.10.1"><link rel="manifest" href="/manifest.webmanifest"><meta http-equiv="content-language" content="en"><link rel="alternate" type="application/rss+xml" title="RSS feed" href="/rss.xml"><link rel="alternate" type="application/feed+json" title="JSON feed" href="/feed.json"><!-- Canonical URL --><link rel="canonical" href="https://dobla.do/blog/writing-browser-extensions-without-compiling/"><link rel="sitemap" href="/sitemap-index.xml"><!-- Primary Meta Tags --><title>Writing browser extensions without compiling - Daniel Doblado</title><meta name="title" content="Writing browser extensions without compiling"><meta name="description" content="Positive development changes for one of my extensions."><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://dobla.do/blog/writing-browser-extensions-without-compiling/"><meta property="og:title" content="Writing browser extensions without compiling"><meta property="og:description" content="Positive development changes for one of my extensions."><meta property="og:image" content="https://dobla.do/orb512.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://dobla.do/blog/writing-browser-extensions-without-compiling/"><meta property="twitter:title" content="Writing browser extensions without compiling"><meta property="twitter:description" content="Positive development changes for one of my extensions."><meta property="twitter:image" content="https://dobla.do/orb512.png"><style>article{margin:0 auto;max-width:46rem}article p{margin-bottom:2em}@media screen and (min-width: 468px){article{margin-top:2rem}}.toArticle{position:fixed;top:-100%;left:50%;transform:translate(-50%);transition:top .3s ease-in-out;padding:0 1rem}.toArticle:focus{top:1%}#title{text-align:left}.date{text-align:right;font-style:italic}.description{font-size:2rem;line-height:110%;text-align:center}@keyframes adjust-progressbar{0%{height:0}to{height:100%}}aside:before,aside:after{content:"";position:absolute;top:0;left:0;width:.25rem;height:100%;background:var(--text);border-radius:.25rem}@supports (animation-timeline: scroll(block root)){aside:after{background:var(--accent);animation:adjust-progressbar;animation-timeline:scroll(block root);animation-duration:auto}}aside{display:none;position:fixed;left:1rem;top:50%;max-width:15rem;transform:translateY(-50%);max-height:50vh;padding-left:1rem;padding-right:1rem}aside ul{list-style:none;margin:0;padding:0}aside a{text-overflow:ellipsis;display:inline-block;text-decoration:none;transition:transform .2s ease-out;transform-origin:left;line-height:1;padding-bottom:.5rem;color:var(--text)}aside a.active{color:var(--accent)}aside a:hover{transform:scale(1.1);color:var(--accent)}pre{margin-bottom:2rem}@media screen and (min-width: 992px){img,pre{--space: 8rem;width:calc(100% + var(--space));position:relative;left:calc(var(--space) / -2);max-width:calc(100% + var(--space))!important}#title{--space: 5rem;width:calc(100% + var(--space));position:relative;left:calc(var(--space) / -2);font-size:4rem}}@media screen and (min-width: 1300px){aside{display:block}}summary{cursor:pointer}.details{font-family:Courier New,monospace;padding-top:1rem}#metadata{display:flex;flex-direction:column;justify-content:space-between;font-size:.8rem}.tags{display:flex;flex-wrap:wrap;column-gap:.5rem;justify-content:flex-end}.metaSection{gap:1.5rem;display:flex;justify-content:space-between;border-top:1px solid var(--text);padding-top:.2rem;padding-bottom:.2rem}.centered{padding-top:1rem}.correctLink{margin-top:1.5rem}@media print{article{max-width:210mm;width:210mm}.toArticle,.date,.correctLink,details{display:none}}
:root{--background: rgb(22, 22, 22);--accent: rgb(250, 250, 250);--text: rgb(161, 161, 170);--link: rgb(255, 99, 71);--paddingSides: 1.5rem;--transparentBackground: rgb(22, 22, 22, .4);--border: rgb(41, 42, 49)}html{scrollbar-gutter:stable}@media not (prefers-reduced-motion){html{scroll-behavior:smooth}}body{font-family:Trebuchet MS,sans-serif;margin:0;padding:0;text-align:left;word-wrap:break-word;overflow-wrap:break-word;color:var(--text);line-height:1.7;background-color:var(--background);display:flex;flex-direction:column;min-height:100vh}::selection{color:var(--accent);background:#ff6347cc}h1,h2,h3,h4,h5,h6{margin:0 0 .5rem;line-height:1.2;color:var(--accent)}h1{font-size:2.5em}h2{font-size:2.441em}h3{font-size:1.953em}h4{font-size:1.563em}h5{font-size:1.25em}strong,b{color:var(--accent);font-weight:700}a{color:var(--accent);position:relative;text-decoration:none;background:linear-gradient(0deg,var(--link),var(--link)) no-repeat right bottom / 0 var(--bg-h);transition:background-size .35s;--bg-h: 100%;padding-bottom:2px;--bg-h: 2px}a:hover{background-size:100% var(--bg-h);background-position-x:left}p{margin-bottom:1em;color:var(--text)}textarea{width:100%;font-size:16px}input{font-size:16px}table{width:100%}img{max-width:100%;height:auto;border-radius:8px}code{padding:2px 5px;border-radius:2px;color:#9ecbff;border:1px solid #9ecbff;background:#24292f}pre{padding:1.5em;border-radius:8px}pre>code{all:unset}blockquote{border-left:4px solid var(--accent);padding:0 0 0 20px;margin:0;font-size:1.333em}hr{border:none;border-top:1px solid rgb(229,233,240)}.centered{text-align:center}@media screen and (min-width: 468px){body{--paddingSides: 4rem}h1{font-size:3.052em}}@media print{*{-webkit-transition:none!important;transition:none!important}body{--background: white;--text: black;--accent: charcoal}}a[data-astro-cid-eimmu3lg]{color:var(--text)}a[data-astro-cid-eimmu3lg].active{color:var(--accent);transform:scale(1.01);text-decoration-color:var(--accent)}.pattern[data-astro-cid-pj7xj6mf]{--fill: rgba(255, 255, 255, .15);position:absolute;top:-5%;left:0;width:100%;height:30vh;background-size:7px 7px;-webkit-mask-image:radial-gradient(at top center,var(--background) 45%,transparent 70%);mask-image:radial-gradient(at top center,var(--background) 45%,transparent 70%);background-image:radial-gradient(var(--fill) 1px,transparent 0);pointer-events:none;z-index:-1}.bottom[data-astro-cid-pj7xj6mf]{top:auto;bottom:0;-webkit-mask-image:radial-gradient(at bottom center,var(--background) 45%,transparent 70%);mask-image:radial-gradient(at bottom center,var(--background) 45%,transparent 70%)}header[data-astro-cid-3ef6ksr2]{margin:0;padding:0 var(--paddingSides);padding-top:2rem;z-index:1}h1[data-astro-cid-3ef6ksr2] a[data-astro-cid-3ef6ksr2]{color:var(--accent);text-decoration:none}h1[data-astro-cid-3ef6ksr2]{margin:0;font-size:3em;text-align:center;font-weight:100}nav[data-astro-cid-3ef6ksr2]{display:flex;align-items:center;justify-content:space-between;flex-direction:column;gap:1.5rem;align-items:stretch}.internalLinks[data-astro-cid-3ef6ksr2]{font-size:1.3em;display:flex;justify-content:center;align-items:center;gap:.8rem}@media screen and (min-width: 768px){h1[data-astro-cid-3ef6ksr2]{font-size:3em}nav[data-astro-cid-3ef6ksr2]{flex-direction:row}.internalLinks[data-astro-cid-3ef6ksr2]{flex-wrap:wrap}}svg[data-astro-cid-3ef6ksr2]{width:1rem;fill:var(--text)}@media print{header[data-astro-cid-3ef6ksr2]{display:none}}footer[data-astro-cid-sz7xmlte]{position:relative;flex-wrap:wrap;padding-left:var(--paddingSides);padding-right:var(--paddingSides);padding-bottom:2rem;display:flex;justify-content:space-evenly;align-items:center;gap:1em;font-size:1.3rem;font-weight:600;z-index:2;text-shadow:1px 1px 1px var(--background)}@media screen and (min-width: 768px){footer[data-astro-cid-sz7xmlte]{justify-content:center}}@media print{footer[data-astro-cid-sz7xmlte]{display:none}}main[data-astro-cid-colb5upu]{flex:1}section[data-astro-cid-colb5upu]{padding-top:2rem;padding-bottom:2rem;padding-left:var(--paddingSides);padding-right:var(--paddingSides)}
.separator[data-astro-cid-jchhmuzl]{color:var(--link)}
</style><script type="module" src="/_astro/hoisted.0t_igHUF.js"></script></head> <body data-js="false" data-astro-cid-colb5upu> <a class="toArticle" href="#article">To the article</a> <header data-astro-cid-3ef6ksr2> <nav data-astro-cid-3ef6ksr2> <h1 data-astro-cid-3ef6ksr2> <a href="/" data-astro-cid-3ef6ksr2>Daniel Doblado</a> </h1> <div class="internalLinks" data-astro-cid-3ef6ksr2> <a href="/blog" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Blog </a>  <a href="/projects" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Projects </a>  <a href="/tags" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg> Tags </a>  <a href="/rss.xml" title="RSS" data-astro-cid-3ef6ksr2 data-astro-cid-eimmu3lg>  <svg width="1.01em" height="1em" viewBox="0 0 82.459 82.347" data-astro-cid-3ef6ksr2 data-icon="rss">  <symbol id="ai:local:rss"><g fill="currentColor" transform="translate(-10.112 -9.668)"><circle cx="21.243" cy="80.884" r="11.131"/><path d="M18.229 40.126a7.626 7.626 0 1 0 0 15.253c15.917 0 28.865 12.95 28.865 28.865a7.626 7.626 0 0 0 7.628 7.627 7.627 7.627 0 0 0 7.627-7.627c0-24.326-19.793-44.118-44.12-44.118z"/><path d="M17.997 9.668a7.628 7.628 0 0 0 0 15.254c32.708.001 59.32 26.613 59.32 59.322a7.627 7.627 0 1 0 15.254 0c0-41.118-33.453-74.573-74.574-74.576z"/></g></symbol><use xlink:href="#ai:local:rss"></use>  </svg>  </a>  <!-- <ThemeToggle /> --> </div> </nav> <div class="pattern" data-astro-cid-pj7xj6mf></div> </header> <main data-astro-cid-colb5upu> <section data-astro-cid-colb5upu>   <article id="article"> <header> <h1 id="title">Writing browser extensions without compiling</h1> <div class="date"> 3 min read<span class="separator" data-astro-cid-jchhmuzl>&nbsp;Â·&nbsp;</span><time datetime="2021-06-24T00:00:00.000Z"> Jun 24, 2021 </time>  </div> </header> <aside> <ul> <li> <a title="Navigate to the start of the article" href="#title">Start</a> </li> <li> <a href="#complexity-is-the-enemy">Complexity is the enemy</a> </li><li> <a href="#coming-with-simpler-solutions">Coming with simpler solutions</a> </li><li> <a href="#how-it-ended">How it ended</a> </li> <li> <a id="metadataLink" title="Navigate to the end of the article" href="#metadata">Metadata</a> </li> </ul> </aside> <p class="description"> Positive development changes for one of my extensions. </p>  <h2 id="complexity-is-the-enemy">Complexity is the enemy<a aria-hidden="true" tabindex="-1" href="#complexity-is-the-enemy"><span class="icon icon-link"></span></a></h2>
<p>Recently one of my most popular <a href="https://github.com/dobladov/youtube2Anki" rel="nofollow" target="_blank">extensions</a> received a full refactor, previously it was made with just pure JavaScript; this was fine since at the beginning it was a proof of concept, it means no complex bundles, frameworks, compilers, â¦</p>
<p>But with complexity comes necessity, managing the state of the connection between the extension and Anki and editing the sentences got complicated using imperative logic; Itâs amazing how used I became to declarative logic with <a href="https://reactjs.org/" rel="nofollow" target="_blank">React</a> and this is something that I was missing for this extension.</p>
<p>I could use React, the problem is that if the extension needs to be compiled, the review in the extensions stores will be more exhaustive, taking more time and making it longer to fix simple stuff like bugs.</p>
<p>So in order to build trust and avoid wasting reviewerâs time, all the code needed to stay just as it was written.</p>
<p>Tools like <a href="https://www.snowpack.dev/" rel="nofollow" target="_blank">snowpack</a> made me realize that with the advance of JavaScript modules, we might not need to compile what itâs an interpreted language, seriously how did we reach this point.</p>
<h2 id="coming-with-simpler-solutions">Coming with simpler solutions<a aria-hidden="true" tabindex="-1" href="#coming-with-simpler-solutions"><span class="icon icon-link"></span></a></h2>
<p>Letâs look at the requirements, I wanted to use components, separate my logic from styles, use declarative logic, not set up any bundler (webpack, parcel, etcâ¦) for this React would not make the cut since JSX needs some tooling and care.</p>
<p>So the decision went to <a href="https://skruv.io/" rel="nofollow" target="_blank">Skruv</a>, this framework is amazing, not only is tiny, modular and simple to learn, the docs are amazing well organized and clear, covering all functionality without extras.</p>
<p>You can tell how nice the framework is by looking at this frameworkâs goals:</p>
<ul>
<li>No build time or runtime dependencies, no parsers</li>
<li>Pretty small:
<ul>
<li>~350 LOC vDOM</li>
<li>~100 LOC State management</li>
<li>~300 LOC HTML/SVG helpers</li>
</ul>
</li>
<li>Useable without bundling/compilation/transpilation</li>
<li>Fast enough for most normal use cases: <a href="https://krausest.github.io/js-framework-benchmark/2023/table_chrome_116.0.5845.82.html" rel="nofollow" target="_blank">benchmark</a></li>
<li>Supports async components like <code>import()</code> and <code>async</code> generators</li>
<li>CSS scoping via shadow DOM</li>
<li>Hopefully grokable/understandable code</li>
</ul>
<p>The best part is that to use it I just have to import the files, thatâs it.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="javascript"><code><span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { div } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "./skruv/html.js"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"><span style="color:#F97583">import</span><span style="color:#E1E4E8"> { renderNode } </span><span style="color:#F97583">from</span><span style="color:#9ECBFF"> "./skruv/vDOM.js"</span><span style="color:#E1E4E8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583">let</span><span style="color:#E1E4E8"> root </span><span style="color:#F97583">=</span><span style="color:#E1E4E8"> document.</span><span style="color:#B392F0">querySelector</span><span style="color:#E1E4E8">(</span><span style="color:#9ECBFF">"#root"</span><span style="color:#E1E4E8">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8">root </span><span style="color:#F97583">=</span><span style="color:#B392F0"> renderNode</span><span style="color:#E1E4E8">(</span><span style="color:#B392F0">div</span><span style="color:#E1E4E8">({}, </span><span style="color:#9ECBFF">"Hello world!"</span><span style="color:#E1E4E8">), root);</span></span>
<span class="line"></span></code></pre>
<p>On top of those advantages, I love the nested syntax, far shorter than JSX, now that I think about it feels weird that we moved to write HTML in JS.</p>
<p>You might be also wondering, âwhat if I need typescript, do you have to transpile?â the answer is no, you can use <a href="https://www.typescriptlang.org/docs/handbook/jsdoc-supported-types.html" rel="nofollow" target="_blank">JSDocs with Typescript</a> without having to create a single <code>ts</code> file.</p>
<h2 id="how-it-ended">How it ended<a aria-hidden="true" tabindex="-1" href="#how-it-ended"><span class="icon icon-link"></span></a></h2>
<p>I feel this change was a success, new code can be iterated easily without having to worry much about state or building, since the extension runs on modern browsers I donât have to care about babel, etc</p>
<p>Right now the only concern I have about the extension is <em>manifest v3</em> which is not supported in Firefox yet, but this is a story for another post.</p>
<p>I have to say that Iâm glad about the feedback people gave, this refactor was motivated because changes on Youtube made it fail and people reported issues with a lot of support, not only that, but Iâve seen articles written in Vietnamese, Japanese and German in how to use the extension and how they find it useful, it really makes me want to keep contributing free, anti-traking open-source code.</p>  <!-- <Share title={title} description={description} url={href} /> --> <details class="details"> <summary>Metadata</summary> <div id="metadata"> <div class="metaSection"> <span class="title">Published</span> <time datetime="2021-06-24T00:00:00.000Z"> Jun 24, 2021 </time> </div>  <div class="metaSection"> <span class="title">Length</span> <span>3 min read (560 words)</span> </div> <div class="metaSection"> <span class="title">License</span> <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a> </div> <div class="metaSection"> <span class="title">Tags</span> <div class="tags"> <a href="/tags/javascript">#javascript</a><a href="/tags/extensions">#extensions</a><a href="/tags/tooling">#tooling</a><a href="/tags/framework">#framework</a><a href="/tags/firefox">#firefox</a><a href="/tags/chrome">#chrome</a><a href="/tags/manifest">#manifest</a> </div> </div> <div class="centered"> <a class="correctLink" target="_blank" href="https://github.com/dobladov/astro-blog/edit/main/src/content/blog/writing-browser-extensions-without-compiling.md">Did I make a mistake? Please consider sending a pull request</a> </div> <script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"Writing browser extensions without compiling","editor":"Daniel Doblado","genre":"javascript extensions tooling framework firefox chrome manifest","keywords":"javascript extensions tooling framework firefox chrome manifest","wordcount":560,"url":"https://dobla.do/blog/writing-browser-extensions-without-compiling/","datePublished":"2021-06-24T00:00:00.000Z","dateCreated":"2021-06-24T00:00:00.000Z","description":"Positive development changes for one of my extensions.","author":{"@type":"Person","name":"Daniel Doblado"}}</script> </div> </details> <div class="progress"></div> </article>  </section> </main> <footer data-astro-cid-sz7xmlte> <a target="_blank" href="https://codepen.io/dobladov" data-astro-cid-sz7xmlte>CodePen</a> <a target="_blank" href="mailto:danieldoblado@gmail.com" data-astro-cid-sz7xmlte>E-Mail</a> <a target="_blank" href="https://github.com/dobladov" data-astro-cid-sz7xmlte>GitHub</a> <a target="_blank" href="https://stackoverflow.com/users/2498992/daniel-doblado" data-astro-cid-sz7xmlte>StackOverflow</a> <div class="pattern bottom" data-astro-cid-pj7xj6mf></div> </footer>  </body></html> 